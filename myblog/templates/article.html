{% extends "base.html" %}

{% block title %}
我的文章
{% endblock %}

{% block link %}
    <link href="/statics/css/zzsc.css" rel="stylesheet" type="text/css"/>
{% endblock %}

{% block container %}
<article>
  <aside class="l_box">
 <div class="search">
      <form action="/search/" method="get" name="searchform" id="searchform">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
          {% if key_word %}
            <input name="keyboard" id="keyboard" class="input_text" value={{ key_word }} style="color: rgb(153, 153, 153);" onfocus="if(value=={{ key_word }}){this.style.color='#000';value=''}" onblur="if(value==''){this.style.color='#999';value={{ key_word }}" type="text">
          {% else %}
              <input name="keyboard" id="keyboard" class="input_text" value="请输入关键字词" style="color: rgb(153, 153, 153);" onfocus="if(value=='请输入关键字词'){this.style.color='#000';value=''}" onblur="if(value==''){this.style.color='#999';value='请输入关键字词'}" type="text">
          {% endif %}
        <input name="Submit" class="input_submit" value="搜索" type="submit">
      </form>
    </div>
    <div class="fenlei" style="overflow: visible">
      <div>
        <h2>文章标签</h2>
        <hr>
        <ul>
          {% for tag_obj in data.tag_obj_list %}
              {% if tag_obj.name == "站长推荐" %}
                  <li style="display: none"></li>
              {% else %}
                  {% if tag_id %}
                      {% if tag_obj.id == tag_id %}
                          <li><a style="color: red" href="/article/tag/?tag_id={{ tag_obj.id }}">{{ tag_obj.name }}({{ tag_obj.article.filter_by(article_status="发布").all() | length }})</a></li>
                      {% else %}
                          <li><a href="/article/tag/?tag_id={{ tag_obj.id }}">{{ tag_obj.name }}({{ tag_obj.article.filter_by(article_status="发布").all() | length }})</a></li>
                      {% endif %}
                  {% else %}
                      <li><a href="/article/tag/?tag_id={{ tag_obj.id }}">{{ tag_obj.name }}({{ tag_obj.article.filter_by(article_status="发布").all() | length }})</a></li>
                  {% endif %}
              {% endif %}
          {% endfor %}
        </ul>
      </div>
    </div>
    <div class="tuijian" style="overflow: visible">
      <div>
        <h2>站长推荐</h2>
        <hr>
        <ul>
          {% for article_obj in data.recommend.article %}
              <li><a href="/detail/?article_id={{ article_obj.id }}">{{ article_obj.title }}</a></li>
          {% endfor %}
        </ul>
      </div>
     </div>
     <div class="tuijian" style="overflow: visible">
      <div>
          <h2>点击排行</h2>
          <hr>
          <ul>
            <li><a href="/">你是什么人便会遇上什么人</a></li>
            <li><a href="/">帝国cms 列表页调用子栏目，没有则不显示栏目名称</a></li>
            <li><a href="/">第二届 优秀个人博客模板比赛参选活动</a></li>
            <li><a href="/">个人博客模板《绅士》后台管理</a></li>
            <li><a href="/">你是什么人便会遇上什么人</a></li>
            <li><a href="/">帝国cms 列表页调用子栏目，没有则不显示栏目名称</a></li>
            <li><a href="/">第二届 优秀个人博客模板比赛参选活动</a></li>
            <li><a href="/">个人博客模板《绅士》后台管理</a></li>
          </ul>
     </div>
    </div>
    <div id="tagscloud" style="overflow: visible">
        <div>
            <h2>猜你喜欢</h2>
            <hr>
            <a href="/detail/?article_id={{ random_article_list[0].id }}" class="tagc1" target="_blank">{{ random_article_list[0].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[1].id }}" class="tagc2" target="_blank">{{ random_article_list[1].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[2].id }}" class="tagc3" target="_blank">{{ random_article_list[2].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[3].id }}" class="tagc4" target="_blank">{{ random_article_list[3].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[4].id }}" class="tagc5" target="_blank">{{ random_article_list[4].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[5].id }}" class="tagc1" target="_blank">{{ random_article_list[5].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[6].id }}" class="tagc2" target="_blank">{{ random_article_list[6].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[0].id }}" class="tagc3" target="_blank">{{ random_article_list[0].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[1].id }}" class="tagc4" target="_blank">{{ random_article_list[1].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[2].id }}" class="tagc5" target="_blank">{{ random_article_list[2].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[3].id }}" class="tagc1" target="_blank">{{ random_article_list[3].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[4].id }}" class="tagc2" target="_blank">{{ random_article_list[4].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[5].id }}" class="tagc3" target="_blank">{{ random_article_list[5].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[6].id }}" class="tagc4" target="_blank">{{ random_article_list[6].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[0].id }}" class="tagc5" target="_blank">{{ random_article_list[0].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[1].id }}" class="tagc1" target="_blank">{{ random_article_list[1].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[2].id }}" class="tagc2" target="_blank">{{ random_article_list[2].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[3].id }}" class="tagc3" target="_blank">{{ random_article_list[3].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[4].id }}" class="tagc4" target="_blank">{{ random_article_list[4].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[5].id }}" class="tagc5" target="_blank">{{ random_article_list[5].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[6].id }}" class="tagc1" target="_blank">{{ random_article_list[6].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[0].id }}" class="tagc2" target="_blank">{{ random_article_list[0].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[1].id }}" class="tagc3" target="_blank">{{ random_article_list[1].title }}</a>
            <a href="/detail/?article_id={{ random_article_list[2].id }}" class="tagc4" target="_blank">{{ random_article_list[2].title }}</a>
        </div>
    </div>
    <div class="guanzhu" style="overflow: visible">
        <div>
            <h2>关注我 么么哒</h2>
            <hr>
            <ul>
              <img src="/statics/images/wxqr.jpg">
            </ul>
        </div>
    </div>
  </aside>

  <main class="r_box">
    {% if request.path != "/article/" %}
        {% if type_obj %}
            <div class="container-header">
                <p><a href="/article/">我的文章</a> >> {{ type_obj.name }}</p>
            </div>
        {% else %}
            <div class="container-header">
                <p><a href="/article/">我的文章</a> >> {{ tag_obj.name }}</p>
            </div>
        {% endif %}
    {% endif %}
      {% if data.data_list == [] %}
          <h3>抱歉，没有找到您想要的结果！</h3>
      {% else %}
      {% for article_obj in data.data_list %}
      <li class="alt-list" id="art-list"><i><a href="/"><img class="article-image" src="/statics/images/article_picture/{{ article_obj.article_picture }}"></a></i>
            <h4><a href="/detail/?article_id={{ article_obj.id }}" target="_blank">{{ article_obj.title }}</a></h4>
            <p>{{ article_obj.description }}</p><br>
            <hr>
              <span class="a-time"><i class="iconfont icon-time"></i>&nbsp;{{ article_obj.created_date }}</span>
              <span class="a-author"><i class="iconfont icon-author"></i>&nbsp;&nbsp;{{ article_obj.author }}</span>
              <span class="a-view"><i class="iconfont icon-view"></i>&nbsp;{{ article_obj.article_browse }}浏览</span>
              <span class="a-comment"><i class="iconfont icon-comment"></i>&nbsp;<a style="color: #00a67c" href="/detail/?article_id={{ article_obj.id }}/#plpost" target="_blank">{{ article_obj.comment.count() }}评论</a></span>
              <a style="cursor: pointer;color: #f78585"><span class="a-praise1 like1" id="{{ article_obj.id }}" value="{{ article_obj.article_praise }}"><i class="iconfont icon-praise1"></i>&nbsp;{{ article_obj.article_praise }}喜欢</span></a>
              <a style="color: #f78585;"><span style="display: none" class="a-praise like2"><i class="iconfont icon-praise"></i>&nbsp;{{ article_obj.article_praise+1 }}喜欢</span></a>
      </li>
      {% endfor %}
      {% endif %}
    {% if not data.data_list == [] %}
    <div class="pagelist">
        {% if data.pre_page %}
            <a href="/article/?page={{ data.pre_page }}">上一页</a>
        {% else %}
            <a href="#">上一页</a>
        {% endif %}
        {% for page in data.page_range %}
            {% if page == data.current_page %}
                <a href="#" class="curPage">{{ page }}</a>&nbsp;&nbsp;
            {% else %}
                <a href="/article/?page={{ page }}">{{ page }}</a>
            {% endif %}
        {% endfor %}
        {% if data.next_page %}
            <a href="/article/?page={{ data.next_page }}">下一页</a>
        {% else %}
            <a href="#">下一页</a>
        {% endif %}
    </div>
    {% endif %}

  </main>
</article>
{% endblock %}
{% block script %}
    <script src='/statics/js/zzsc.js' type="text/javascript"></script>
    <script src="/statics/js/jquery.min.js"></script>
    <script type="text/javascript">
         $(".like1").click(function () {
            var id = $(this).attr("id");
            var article_praise = $(this).attr("value");
            $(this).css("display","none");
            $(this).parent().next().children().css("display","inline");
            $.get("/add_praise/",{"id":id,"article_praise":article_praise},function (data) {
                console.log(data)
            })
        });
    </script>
{% endblock %}